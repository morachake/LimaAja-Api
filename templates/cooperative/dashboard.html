{% extends 'cooperative/dashboard_base.html' %}
{% load static %}

{% block page_title %}
    {% if view == 'farmers' %}
        Farmers Management
    {% elif view == 'products' %}
        Products Management
    {% elif view == 'orders' %}
        Orders & Sales
    {% elif view == 'settings' %}
        Account Settings
    {% else %}
        Dashboard Overview
    {% endif %}
{% endblock %}

{% block dashboard_content %}
    {% if view == 'farmers' %}
        {% include 'cooperative/dashboard/farmers.html' %}
    {% elif view == 'products' %}
        {% include 'cooperative/dashboard/products.html' %}
    {% elif view == 'orders' %}
        {% include 'cooperative/dashboard/orders.html' %}
    {% elif view == 'settings' %}
        {% include 'cooperative/dashboard/settings.html' %}
    {% else %}
        <!-- Dashboard Overview -->
        <div class="dashboard-cards">
            <div class="dashboard-card">
                <div class="card-header">
                    <div class="card-title">Total Farmers</div>
                    <div class="card-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                            <circle cx="9" cy="7" r="4"></circle>
                            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                        </svg>
                    </div>
                </div>
                <div class="card-value">{{ farmers.count }}</div>
                <div class="card-description">Registered farmers</div>
            </div>
            
            <div class="dashboard-card">
                <div class="card-header">
                    <div class="card-title">Total Products</div>
                    <div class="card-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>
                            <rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>
                        </svg>
                    </div>
                </div>
                <div class="card-value">{{ products.count }}</div>
                <div class="card-description">Listed products</div>
            </div>
            
            <div class="dashboard-card">
                <div class="card-header">
                    <div class="card-title">Active Orders</div>
                    <div class="card-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="9" cy="21" r="1"></circle>
                            <circle cx="20" cy="21" r="1"></circle>
                            <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                        </svg>
                    </div>
                </div>
                <div class="card-value">0</div>
                <div class="card-description">Pending orders</div>
            </div>
            
            <div class="dashboard-card">
                <div class="card-header">
                    <div class="card-title">Verification Status</div>
                    <div class="card-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                            <polyline points="22 4 12 14.01 9 11.01"></polyline>
                        </svg>
                    </div>
                </div>
                <div class="card-value">{{ request.user.is_approved|yesno:"Approved,Pending" }}</div>
                <div class="card-description">Account verification status</div>
            </div>
        </div>
        
        <div class="dashboard-tables">
            <div class="table-container">
                <div class="table-header">
                    <h2 class="table-title">Recent Farmers</h2>
                    <a href="{% url 'cooperative_dashboard' %}?view=farmers" class="table-action">
                        View All
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polyline points="9 18 15 12 9 6"></polyline>
                        </svg>
                    </a>
                </div>
                <div class="table-content">
                    {% if farmers %}
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Phone</th>
                                    <th>Joining Date</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for farmer in farmers|slice:":5" %}
                                <tr>
                                    <td>{{ farmer.name }}</td>
                                    <td>{{ farmer.phone_number }}</td>
                                    <td>{{ farmer.joining_date }}</td>
                                    <td>
                                        {% if farmer.is_active %}
                                            <span class="status-badge status-active">Active</span>
                                        {% else %}
                                            <span class="status-badge status-inactive">Inactive</span>
                                        {% endif %}
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    {% else %}
                        <p class="text-center py-4">No farmers added yet.</p>
                    {% endif %}
                </div>
            </div>
            
            <div class="table-container">
                <div class="table-header">
                    <h2 class="table-title">Recent Products</h2>
                    <a href="{% url 'cooperative_dashboard' %}?view=products" class="table-action">
                        View All
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polyline points="9 18 15 12 9 6"></polyline>
                        </svg>
                    </a>
                </div>
                <div class="table-content">
                    {% if products %}
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Farmer</th>
                                    <th>Price</th>
                                    <th>Quantity</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for product in products|slice:":5" %}
                                <tr>
                                    <td>{{ product.name }}</td>
                                    <td>{{ product.farmer.name }}</td>
                                    <td>${{ product.price }}</td>
                                    <td>{{ product.quantity }}</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    {% else %}
                        <p class="text-center py-4">No products added yet.</p>
                    {% endif %}
                </div>
            </div>
        </div>
    {% endif %}
{% endblock %}

